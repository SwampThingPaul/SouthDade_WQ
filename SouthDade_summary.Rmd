---
title: "South Dade Conveyance System Environmental Information"
author: "Point of Contact: Paul Julian (<paul.julian@dep.state.fl.us>)" 
output: html_document
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r stuff,include=F}
#Clears Everything...start fresh.
rm(list=ls(all=T));#cat("\014");dev.off()
getOption("timeout")
options(timeout=60*7)

#Set Working Directory
wd="//Fldep1/OWPER/EVG/Programmatic/WaterQuality/2_WQ Project Analyses/COP_Planning"

##Libraries
library(reshape)
library(plyr)
library(openxlsx)
library(leaflet)
library(Hmisc)
##Custom Functions
source("D:/CommonlyUsedFunctions.r")

#data
flow.sites=read.xlsx(paste(wd,"/DataInventory_existing.xlsx",sep=""),sheet=1)
wq.sites=read.xlsx(paste(wd,"/DataInventory_existing.xlsx",sep=""),sheet=2)
wq.sites2=ddply(wq.sites,"Station.ID",summarise,N.val=N(Station.ID))#$Station.ID
map.dat=read.xlsx(paste(wd,"/DataInventory_existing.xlsx",sep=""),sheet=3)

flow.sites=subset(flow.sites,Structure!="S176Temp")
flow.sites=subset(flow.sites,Structure!="S328")
flow.sites=subset(flow.sites,Structure!="G737")

dates=as.Date(c("1978-05-01","2016-04-30"))

#paste(flow.sites$DBKEY,collapse="/")

```

**_Please note this analysis is for informational purposes only and subject to change._** 



# Hydrologic Information

Provided in this section are period of record (POR) discharge data and associated metrics of available data in the South Florida Water Management Districts [DBHYDRO](http://my.sfwmd.gov/dbhydroplsql/show_dbkey_info.main_menu). All structure DBKEYs used to construct these discharge time-series can be found in this [file](https://github.com/SwampThingPaul/SouthDade_WQ/blob/master/DataInventory_existing.xlsx?raw=true).

```{r hydro map data, include=F}
map.dat$Tip=with(map.dat,paste("Structure: ",SITE,"<BR> Inflow Area:",Inflow_Area,sep=""))
```

```{r map,echo=F,fig.width=4,fig.height=4.5,fig.align='center'}
leaflet(width="100%") %>%
  setView(lng=-80.55,lat=25.46,zoom=10)%>%
  addProviderTiles(providers$Esri.WorldImagery) %>%
  addProviderTiles(providers$OpenStreetMap,options=providerTileOptions(opacity=0.4)) %>%
  addMarkers(lng=map.dat$Long,lat=map.dat$Lat,popup=map.dat$Tip,label=map.dat$SITE,labelOptions=labelOptions(noHide=T,textsize="10px"))%>%
  #addLabelOnlyMarkers(lng=map.dat$Long,lat=map.dat$Lat,label=map.dat$SITE,labelOptions = labelOptions(noHide = T, direction = 'bottom', textOnly = T))%>%
  addMiniMap(tiles = providers$ESRI, toggleDisplay = TRUE,position = "bottomleft")
  
```

```{r flow data,include=F}
###Flow Data
#flow=NA
#for(i in 1:nrow(flow.sites)){
#  tmp=SFWMD.DBHYDRO.Data.daily(dates[1],dates[2],flow.sites$DBKEY[i])
#  tmp$DBKEY=flow.sites$DBKEY[i]
#  flow=rbind(tmp,flow)
#  print(i)
#}
#flow$WY=WY(flow$Date,"FL")
#flow=merge(flow,flow.sites,"DBKEY")
flow=read.csv("REPORT_flow.csv",skip=nrow(flow.sites)+2)
flow$Date=with(flow,as.POSIXct(as.character(Daily.Date),format="%d-%b-%Y",tz="America/New_York"))
flow=subset(flow,is.na(Date)==F)
flow=merge(flow,flow.sites,"DBKEY")
flow$WY=WY(flow$Date,"FL")

flow.xtab=data.frame(cast(flow,Date+WY+Structure+Site~Priority,value="Data.Value",fun.aggregate=function(x) ifelse(sum(x,na.rm=T)==0,NA,sum(x,na.rm=T))))
flow.xtab$Date.EST=date.fun(flow.xtab$Date)
#flow.xtab$fflow.cfs=with(flow.xtab,ifelse(is.na(P2)&is.na(P3),P1,ifelse(is.na(P1)&is.na(P3),P2,ifelse(is.na(P1)&is.na(P2),P3,P2))));#final flow value for analysis
flow.xtab$fflow.cfs=with(flow.xtab,ifelse(is.na(P1)&is.na(P2),P3,ifelse(is.na(P1)&is.na(P3),P2,P1)))
plot(fflow.cfs~Date.EST,subset(flow.xtab,Site=="S18C"))
with(subset(flow.xtab,Site=="S18C"),points(Date.EST,P3,pch=21))
plot(P3~Date.EST,subset(flow.xtab,Site=="S18C"))

flow.xtab$fflow.cfs=ifelse(is.na(flow.xtab$fflow.cfs)==T,0,flow.xtab$fflow.cfs)
plot(fflow.cfs~Date.EST,subset(flow.xtab,Site=="S18C"),type="l")
#subset(flow.xtab,Date.EST==date.fun("1992-04-03")&Site=="S174")

##Sanity Check
#range(flow.xtab$fflow.cfs,na.rm=T)
#flow.Sites=unique(flow.xtab$Site)
#for(i in 1:length(flow.Sites)){
#plot(fflow.cfs~Date.EST,subset(flow.xtab,Site==flow.Sites[i]),type="l")
#mtext(side=3,flow.Sites[i])
#}
plot(fflow.cfs~Date.EST,subset(flow.xtab,Site=="S174"),type="l")
plot(fflow.cfs~Date.EST,subset(flow.xtab,Site=="S178"),type="l")
flow.xtab$rev.fflow.cfs=with(flow.xtab,ifelse(fflow.cfs<0,fflow.cfs,0))
flow.xtab$fflow.cfs=ifelse(flow.xtab$fflow.cfs<0,0,flow.xtab$fflow.cfs)
plot(fflow.cfs~Date.EST,subset(flow.xtab,Site=="S178"),type="l")
flow.xtab=merge(flow.xtab,map.dat[,c("SITE","Inflow_Area")],by.x="Site",by.y="SITE")

flow.site.da=ddply(flow.xtab,c("Site","Date.EST","WY","Inflow_Area"),summarise,Q.cfs=sum(fflow.cfs,na.rm=T),rev.Q.cfs=sum(rev.fflow.cfs*-1,na.rm=T))
flow.site.da$Q.m3d=cfs.to.m3d(flow.site.da$Q.cfs)
#write.csv(flow.site.da,paste(export.path,"daily_flow_data.csv",sep=""),row.names = F)
WY.flow=ddply(flow.site.da,c("Site","WY","Inflow_Area"),summarise,Q.m3d=sum(cfs.to.m3d(Q.cfs),na.rm=T))

flow.Sites=unique(WY.flow$Site)
flow.Sites=c("S331","S173","S357","S332B","S332C","S174","S332DX1","S332D","S176","S200","S332","S175","S199","S177","S178","S18C","S197")
da.max=ddply(flow.site.da,c("Site"),summarise,max.val=max(Q.m3d,na.rm=T))
da.max$rnd.val=round(da.max$max.val,-5)

WY.max=ddply(WY.flow,c("Site"),summarise,max.val=max(Q.m3d,na.rm=T))
WY.max$rnd.val=round(WY.max$max.val,-7)

```

<center> Interactive map of structures monitored within the South Dade Conveyance System. Within the current period of record, no data is available for S328 (D-Detention Area) or G737 (Frog Pond Detention Area) to assess annual conditions.</center>

<br>
<br>
Below is a series of plots for each structure with accessible/available data. Only positive flows were used in this analysis. Reverse flow has been observed at some structures The three plots are flow-duration curves using daily data for the entire POR for any given structure (left), daily discharge volume (middle) and total discharge volume based on the Florida Water Year (right). The lower flow-duration limit (20% Exceedance) for each structure has been identified where applicable. All hydrologic data is presented in m^3^ d^-1^ or m^3^ WY^-1^, to convert from m^3^ to acre-feet, multiply values by 0.000810714. 

<br>
<br>

# {.tabset .tabset-fade}
## S331
```{r HydroPlots1,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=1
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S173
```{r HydroPlots2,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=2
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S357
```{r HydroPlots3,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=3
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S332B
```{r HydroPlots4,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=4
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S332C
```{r HydroPlots5,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=5
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S174
```{r HydroPlots6,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=6
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```
<br>

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S332DX1
```{r HydroPlots7,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=7
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S332D
```{r HydroPlots8,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=8
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```
<br>

## S176
```{r HydroPlots9,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=9
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S200
```{r HydroPlots10,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=10
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>
## S332
```{r HydroPlots11,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=11
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S175
```{r HydroPlots12,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=12
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S199
```{r HydroPlots13,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=13
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S177
```{r HydroPlots14,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=14
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S178
```{r HydroPlots15,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=15
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S18C
```{r HydroPlots16,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=16
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>

## S197
```{r HydroPlots17,echo=FALSE,fig.width=7,fig.height=3,fig.align='center' }
i=17
par(family="serif",mar=c(1,2.5,1,2),oma=c(3,4,0.75,0.1));
layout(matrix(seq(1,3,1),1,3,byrow=T));

dat.da=subset(flow.site.da,Site==flow.Sites[i])
fdc.dat.da=fdc.v2(dat.da$Q.m3d)
dat.WY=subset(WY.flow,Site==flow.Sites[i])

#flow duration curve
ylim.val=c(9,9e6);ymaj=c(10^seq(0,9));ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100),seq(1e3,1e4,1e3),seq(1e4,1e5,1e4),seq(1e5,1e6,1e5),seq(1e6,1e7,1e6),seq(1e7,1e8,1e7),seq(1e8,1e9,1e8),seq(1e9,1e10,1e9))#by.y=2;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(fdc.dat.da,lines(PerExceed,flow,lwd=1.5))
if(max(fdc.dat.da$PerExceed)>20){lines(rep(20,2),c(Q.thr(fdc.dat.da,20),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>70){lines(rep(70,2),c(Q.thr(fdc.dat.da,70),0.001),lty=2,col="red",cex=4,lwd=1.5)}
if(max(fdc.dat.da$PerExceed)>20){points(20,Q.thr(fdc.dat.da,20),pch=21,bg="indianred1",cex=1.5)}
if(max(fdc.dat.da$PerExceed)>70){points(70,Q.thr(fdc.dat.da,70),pch=21,bg="indianred1",cex=1.5)}
axis_fun(2,ymaj,ymaj,format(ymaj,scientific=F),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=4.5,expression(paste("Daily Flow ( m "^" -3","d "^" -1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Percent Exceedance",cex=0.9)

ylim.val=c(0,subset(da.max,Site==flow.Sites[i])$rnd.val);by.y=subset(da.max,Site==flow.Sites[i])$rnd.val/5;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
plot(Q.m3d~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.da,shaded.range(Date.EST,rep(0,nrow(dat.da)),Q.m3d,bg="indianred1",lty=0,col.adj = 0.8))
axis_fun(2,ymaj,ymin,format(ymaj/1e4),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.9)
mtext(side=2,line=2,expression(paste("Flow (x10 "^"4"," m "^" 3","day "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Month-Year",cex=0.9)
mtext(side=3,flow.Sites[i])

ylim.val=c(0,subset(WY.max,Site==flow.Sites[i])$rnd.val);by.y=subset(WY.max,Site==flow.Sites[i])$rnd.val/4;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
plot(Q.m3d~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
abline(h=ymaj,v=xmaj,lty=3,col="grey")
with(dat.WY,shaded.range(WY,rep(0,nrow(dat.WY)),Q.m3d,bg="dodgerblue1",col="black",lty=1,col.adj = 0.5))
axis_fun(2,ymaj,ymin,format(ymaj/1e6),1);box(lwd=1)
axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
mtext(side=2,line=2.5,expression(paste("Flow (x10 "^"6"," m "^" 3"," WY "^"-1",")",sep="")),cex=0.9)
mtext(side=1,line=2,"Water Year",cex=0.9)
```
<br>
Daily Discharge Data Summary for the Period of Record (Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(dat.da$Q.m3d))
```

Daily Discharge Data Summary for the last 10-WYs (May 2005 - April 2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.da,WY%in%seq(2006,2016,1))$Q.m3d))
```

Water Year Discharge Data Summary for the Period of Record (Units:m^3^ WY^-1^)
```{r,echo=F }
print(summary(dat.WY$Q.m3d))
```

Water Year Discharge Data Summary for the last 10-WYs (2006-2016; Units:m^3^ d^-1^)
```{r,echo=F }
print(summary(subset(dat.WY,WY%in%seq(2006,2016,1))$Q.m3d))
```
<br>


# Water Quality Information

Provided in this section are period of record water quality data and summaries of data located in the South Florida Water Management Districts [DBHYDRO](http://my.sfwmd.gov/dbhydroplsql/show_dbkey_info.main_menu). All structure-water quality monitoring location pairings used to construct these water quality time-series can be found in this [file](https://github.com/SwampThingPaul/SouthDade_WQ/blob/master/DataInventory_existing.xlsx?raw=true).

<br>
Below are a series of plots for each structure with accessible/available data. The data are presented both as individual grab samples (i.e. raw data) and annual flow-weighted mean concentrations based on the Florida Water Year (May 1 - April 30). Water quality data were screened for fatal qualifiers and paired with flow data for each structure with available data. Flow-weighted mean concentrations were calcualted for structures with greater than three samples per year using only positive flow. Similar to the plots above for discharge data, three plots were developed to represent each structure and the associated water quality (total phosphorus). The three plots include (1) the top left plot displaying a percent exceedance curve for all data (solid line) and only flowing conditions (dashed line) based on grab sample (weekly, biweekly or monthly depending on structure); (2) top right plot displays raw grab sample total phosphorus concentration with points color coded relative to flowing conditions (blue: flowing, red: not flowing); (3) bottom plot displays annual flow-weighted mean concentrations and weighted-standard error (FWM $\pm$ SE~wtd~). All concentrations are expressed as $\mu$g L^-1^ (i.e. parts-per-billion).

```{r wq dat,include=F}

wq.dat=SFWMD.DBHYDRO.Data.WQ(dates[1],dates[2],wq.sites2$Station.ID,25)
wq.dat=subset(wq.dat,Collection.Method%in%c("G","GP"))
wq.dat=merge(wq.dat,wq.sites,"Station.ID")

head(flow.site.da)
vars=c("Date.EST","SITE","Station.ID","HalfMDL")
flow.wq=merge(flow.site.da,wq.dat[,vars],by.x=c("Site","Date.EST"),by.y=c("SITE","Date.EST"),all.x=T)
flow.wq$HalfMDL.ugL=flow.wq$HalfMDL*1000
flow.wq$HalfMDL.ugL.flow=with(flow.wq,ifelse(Q.cfs>0,HalfMDL.ugL,NA))
flow.wq$HalfMDL.ugL.noflow=with(flow.wq,ifelse(Q.cfs>0,NA,HalfMDL.ugL))
flow.wq$crossprod=with(flow.wq,Q.cfs*HalfMDL.ugL)
flow.wq=merge(flow.wq,ddply(flow.wq,c("Site","WY"),summarise,N.val.scn=N(crossprod)),c("Site","WY"))
flow.wq.WY=ddply(subset(flow.wq,is.na(crossprod)==F&N.val.scn>3),c("Site","Inflow_Area","WY"),summarise,FWM=wtd.mean(HalfMDL.ugL,Q.cfs),WSTD=sqrt(wtd.var(HalfMDL.ugL,Q.cfs)),N.val=N(crossprod))
flow.wq.WY$FWM=with(flow.wq.WY,ifelse(is.nan(FWM),NA,FWM))
flow.wq.WY$WSE=with(flow.wq.WY,WSTD/sqrt(N.val))
flow.wq.WY$DOF=with(flow.wq.WY,ifelse(N.val==1,1,N.val-1))  
flow.wq.WY$CI=0.10
flow.wq.WY$Tp=with(flow.wq.WY,abs(qt(CI,DOF)))
flow.wq.WY$CI.Upper=with(flow.wq.WY,FWM+((WSTD*Tp)/sqrt(N.val)))
flow.wq.WY$CI.Lower=with(flow.wq.WY,FWM-((WSTD*Tp)/sqrt(N.val)))
flow.wq.WY
flow.wq.WY$FWM.plot=with(flow.wq.WY,ifelse(is.na(FWM)==T,0,FWM))

sites=unique(flow.wq.WY$Site)
wys=seq(1979,2016,1)
fill.wys=data.frame(Site=sort(rep(sites,length(wys))),WY=rep(wys,length(sites)),fill=1)
flow.wq.WY=merge(flow.wq.WY,fill.wys,all.y=T)

da.wq.max=ddply(flow.wq,c("Site"),summarise,max.val=max(HalfMDL.ugL,na.rm=T))
da.wq.max=data.frame(Site=c("S173", "S174", "S175", "S176", "S177", "S178", "S18C", "S197","S199", "S200", "S331", "S332", "S332B", "S332C", "S332D", "S357"),
                        max.val=c(40,40,60,200,150,350,60,150,32,25,40,60,20,25,60,11),
                        by.val=c(10,10,20,20,50,100,20,25,10,5,10,20,10,5,20,2))

da.wq.wy.max=ddply(flow.wq.WY,c("Site"),summarise,min.val=min(FWM-WSE,na.rm=T),max.val=max(FWM+WSE,na.rm=T))
da.wq.wy.max=data.frame(Site=c("S173", "S174", "S175", "S176", "S177", "S178", "S18C", "S197","S199", "S200", "S331", "S332", "S332B", "S332C", "S332D", "S357"),
           max.val=c(15,20,12,40,20,200,28,100,10,10,10,20,10,10,15,10),
           by.val=c(5,5,2,10,5,50,5,20,2,2,2,5,2,2,5,2))
wq.sites.order=c("S331","S173","S357","S332B","S332C","S174","S332D","S176","S200","S332","S175","S199","S177","S178","S18C","S197")

```

<br>
<br>

# {.tabset .tabset-fade}
## S331
```{r wqplot1,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=1
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da.all,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S173
```{r wqplot2,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=2
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S357
```{r wqplot3,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=3
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S332B
```{r wqplot4,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=4
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S332C
```{r wqplot5,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=5
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S174
```{r wqplot6,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=6
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S332D
```{r wqplot7,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=7
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S176
```{r wqplot8,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=8
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S200
```{r wqplot9,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=9
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S332
```{r wqplot10,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=10
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S175
```{r wqplot11,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=11
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S199
```{r wqplot12,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=12
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S177
```{r wqplot13,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=13
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S178
```{r wqplot14,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=14
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S18C
```{r wqplot15,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=15
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

## S197
```{r wqplot16,echo=FALSE,fig.width=6,fig.height=4.5,fig.align='center' }
i=16
par(family="serif",mar=c(3,1.1,1,1),oma=c(1,2.5,0.75,0.1));
layout(matrix(c(seq(1,3,1),3),2,2,byrow=T));
  dat.da=subset(flow.wq,Site==wq.sites.order[i])
  fdc.dat.da.all=fdc.v2(dat.da$HalfMDL.ugL)
  fdc.dat.da.flow=fdc.v2(dat.da$HalfMDL.ugL.flow)
  dat.WY=subset(flow.wq.WY,Site==wq.sites.order[i])
  
  ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);ymaj=c(1,10,100);ymin=c(seq(1,10,1),seq(10,100,10),seq(100,1000,100))
  xlim.val=c(0,100);by.x=20;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/2)
  plot(flow~PerExceed,fdc.dat.da,type="n",ylim=ylim.val,xlim=xlim.val,yaxs="i",xaxs="i",yaxt="n",xaxt="n",ylab=NA,xlab=NA,log="y");
  abline(h=ymaj,lty=3,col="grey")
  with(fdc.dat.da.all,lines(PerExceed,flow,lwd=2))
  with(fdc.dat.da.flow,lines(PerExceed,flow,lwd=2,lty=2))
  axis_fun(2,ymaj,ymin,format(ymaj,scientific=F),1);box(lwd=1)
  axis_fun(1,xmaj,xmin,xmaj,1)
  mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Percent Exceedance",cex=0.9)
  leg.x=80;leg.y=max(ylim.val);legend.text=c("All Flow","Flow")
  legend(leg.x,leg.y,legend=legend.text,col=c("black"),lty=c(1,2),lwd=1.5,pt.cex=1.5,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5)
  
  #ylim.val=c(1,subset(da.wq.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=date.fun(dates);xmaj=seq(xlim.val[1],xlim.val[2],"15 years");xmin=seq(xlim.val[1],xlim.val[2],"1 years")
  plot(HalfMDL.ugL~Date.EST,dat.da,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i",log="y")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.da,lines(Date.EST,HalfMDL.ugL,col="indianred1",lty=1,lwd=0.75))
  with(dat.da,points(Date.EST,HalfMDL.ugL.noflow,pch=21,bg=adjustcolor("indianred1",0.5),cex=1,lwd=0.1))
  with(dat.da,points(Date.EST,HalfMDL.ugL.flow,pch=21,bg="dodgerblue1",cex=1,lwd=0.1))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,format(xmaj,"%m-%Y"),0.8)
  #mtext(side=2,line=2,expression(paste("TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Month-Year",cex=0.9)
  leg.x=min(xlim.val);leg.y=max(ylim.val);legend.text=c("Flow","No Flow")
  legend(leg.x,leg.y,legend=legend.text,lty=0,pch=21,pt.bg=c("dodgerblue1",adjustcolor("indianred1",0.5)),lwd=0.2,pt.cex=1,ncol=1,cex=0.6,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0)
  
  ylim.val=c(0,subset(da.wq.wy.max,Site==wq.sites.order[i])$max.val);by.y=subset(da.wq.wy.max,Site==wq.sites.order[i])$by.val;ymaj=seq(ylim.val[1],ylim.val[2],by.y);ymin=seq(ylim.val[1],ylim.val[2],by.y/2)
  xlim.val=c(1979,2016);by.x=10;xmaj=seq(xlim.val[1],xlim.val[2],by.x);xmin=seq(xlim.val[1],xlim.val[2],by.x/by.x)
  plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  abline(h=ymaj,v=xmaj,lty=3,col="grey")
  with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",2,21,bg="dodgerblue1",cex=1.5,length=0.03))
  #barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col="white",border=0,space=0,xpd=F)
  #abline(h=ymaj,lty=3,col="grey")
  #x=barplot(dat.WY$FWM,ylim=ylim.val,yaxt="n",col=adjustcolor("dodgerblue1",0.5),border="dodgerblue",add=T,space=0,xpd=F)
  #with(dat.WY,errorbars(x,FWM,WSE,"grey50",length=0.01))
  #plot(FWM~WY,dat.WY,ylim=ylim.val,xlim=xlim.val,yaxt="n",xaxt="n",type="n",ylab=NA,xlab=NA,yaxs="i")
  #abline(h=ymaj,v=xmaj,lty=3,col="grey")
  #with(dat.WY,pt_line_error(WY,FWM,WSE,2,"dodgerblue",1,21,bg="dodgerblue1",length=0.03))
  axis_fun(2,ymaj,ymin,format(ymaj),1);box(lwd=1)
  axis_fun(1,line=-0.5,xmaj,xmin,xmaj,0.9)
  #axis_fun(1,line=-0.5,x[seq(1,38,10)],x,xmaj,0.9)
  mtext(side=2,line=2,expression(paste("FWM TP (",mu,"g","L "^" -1",")",sep="")),cex=0.9)
  mtext(side=1,line=2,"Water Year",cex=0.9)
  mtext(side=3,line=-0.5,wq.sites.order[i],outer=T)
```
<br>

<br>
<br>
***
<br>
<br>